<HTML>

<HEAD>
	<TITLE>BDF Audio Player - –ê—Å—Ç–∞–Ω–∏–Ω 10-12-2025</TITLE>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style type="text/css">
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
			color: #ecf0f1;
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			min-height: 100vh;
			padding: 20px;
		}

		.container {
			max-width: 1200px;
			margin: 0 auto;
			padding: 20px;
		}

		.header {
			text-align: center;
			margin-bottom: 30px;
			padding-bottom: 20px;
			border-bottom: 2px solid #3498db;
		}

		.header h1 {
			font-size: 2.5em;
			color: #3498db;
			text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
			margin-bottom: 10px;
		}

		.header .subtitle {
			color: #bdc3c7;
			font-size: 1.1em;
		}

		.main-content {
			display: flex;
			flex-wrap: wrap;
			gap: 30px;
			margin-bottom: 30px;
		}

		.control-panel {
			flex: 1;
			min-width: 300px;
			max-width: 400px;
			background: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur(10px);
			border-radius: 15px;
			padding: 25px;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
			border: 1px solid rgba(255, 255, 255, 0.1);
			display: flex;
			flex-direction: column;
		}

		.file-upload-area {
			text-align: center;
			padding: 30px 20px;
			border: 3px dashed #3498db;
			border-radius: 10px;
			margin-bottom: 12px;
			transition: all 0.3s ease;
			background: rgba(52, 152, 219, 0.1);
			cursor: pointer;
			flex-shrink: 0;
		}

		.file-upload-area:hover {
			background: rgba(52, 152, 219, 0.2);
			border-color: #2980b9;
		}

		.file-upload-area input[type="file"] {
			display: none;
		}

		.upload-label {
			display: block;
			cursor: pointer;
		}

		.upload-icon {
			font-size: 40px;
			color: #3498db;
			margin-bottom: 10px;
		}

		.upload-text {
			font-size: 1.1em;
			color: #ecf0f1;
			margin-bottom: 8px;
			line-height: 1.3;
		}

		.upload-hint {
			color: #bdc3c7;
			font-size: 0.85em;
			line-height: 1.2;
		}

		.file-info {
			display: none;
			background: rgba(44, 62, 80, 0.7);
			padding: 12px;
			border-radius: 8px;
			margin-bottom: 12px;
			border-left: 4px solid #3498db;
			flex-shrink: 0;
			overflow: hidden;
		}

		.file-info.active {
			display: block;
		}

		.info-item {
			margin: 6px 0;
			display: flex;
			justify-content: space-between;
			font-size: 0.9em;
		}

		.info-label {
			color: #bdc3c7;
			flex-shrink: 0;
			margin-right: 10px;
		}

		.info-value {
			color: #3498db;
			font-weight: 600;
			text-align: right;
			word-break: break-word;
			flex: 1;
			min-width: 0;
		}

		.control-buttons {
			display: flex;
			gap: 12px;
			margin-top: auto;
			padding-top: 0px;
			flex-shrink: 0;
		}

		.btn {
			flex: 1;
			padding: 12px 16px;
			border: none;
			border-radius: 8px;
			font-size: 0.95em;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.3s ease;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 8px;
			min-width: 0;
			max-width: 100%;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		.btn-primary {
			background: linear-gradient(to right, #3498db, #2980b9);
			color: white;
		}

		.btn-primary:hover {
			background: linear-gradient(to right, #2980b9, #2573a7);
			transform: translateY(-2px);
			box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
		}

		.btn-secondary {
			background: rgba(255, 255, 255, 0.1);
			color: #ecf0f1;
			border: 1px solid rgba(255, 255, 255, 0.2);
		}

		.btn-secondary:hover {
			background: rgba(255, 255, 255, 0.2);
			transform: translateY(-2px);
		}

		.btn:disabled {
			opacity: 0.6;
			cursor: not-allowed;
			transform: none !important;
		}

		.btn span {
			overflow: hidden;
			text-overflow: ellipsis;
			white-space: nowrap;
		}

		.visualization-area {
			flex: 2;
			min-width: 500px;
			background: rgba(0, 0, 0, 0.3);
			border-radius: 15px;
			padding: 20px;
			position: relative;
			overflow: hidden;
			box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
			display: flex;
			flex-direction: column;
		}

		.graph-container {
			position: relative;
			width: 100%;
			height: 350px;
			background: rgba(0, 0, 0, 0.5);
			border-radius: 10px;
			overflow: hidden;
			border: 1px solid rgba(255, 255, 255, 0.1);
			flex-shrink: 0;
		}

		#graphCanvas {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			display: block;
		}

		.graph-overlay {
			position: absolute;
			top: 10px;
			left: 10px;
			color: rgba(255, 255, 255, 0.7);
			font-size: 0.85em;
			background: rgba(0, 0, 0, 0.5);
			padding: 5px 10px;
			border-radius: 5px;
		}

		.status-bar {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 15px 20px;
			background: rgba(44, 62, 80, 0.8);
			border-radius: 10px;
			margin-top: 20px;
			flex-shrink: 0;
			flex-wrap: wrap;
			gap: 15px;
		}

		.status-item {
			display: flex;
			flex-direction: column;
			align-items: center;
			flex: 1;
			min-width: 150px;
		}

		.status-label {
			font-size: 0.75em;
			color: #bdc3c7;
			margin-bottom: 3px;
		}

		.status-value {
			font-size: 1em;
			color: #2ecc71;
			font-weight: 600;
			text-align: center;
			word-break: break-word;
		}

		.playback-controls {
			display: flex;
			align-items: center;
			gap: 15px;
			flex: 2;
			min-width: 300px;
		}

		.playback-btn {
			width: 45px;
			height: 45px;
			border-radius: 50%;
			border: none;
			background: #3498db;
			color: white;
			font-size: 1.1em;
			cursor: pointer;
			transition: all 0.3s ease;
			display: flex;
			align-items: center;
			justify-content: center;
			flex-shrink: 0;
		}

		.playback-btn:hover {
			background: #2980b9;
			transform: scale(1.1);
		}

		.playback-btn:disabled {
			background: #7f8c8d;
			cursor: not-allowed;
			transform: none;
		}

		.progress-container {
			flex: 1;
			height: 6px;
			background: rgba(255, 255, 255, 0.1);
			border-radius: 3px;
			cursor: pointer;
			position: relative;
			min-width: 100px;
			flex-shrink: 1;
		}

		.progress-bar {
			position: absolute;
			top: 0;
			left: 0;
			height: 100%;
			background: #3498db;
			border-radius: 3px;
			width: 0%;
			transition: width 0.1s linear;
		}

		.time-display {
			color: #ecf0f1;
			font-family: monospace;
			font-size: 0.9em;
			min-width: 90px;
			text-align: center;
			flex-shrink: 0;
		}

		.footer {
			text-align: center;
			margin-top: 30px;
			padding-top: 20px;
			border-top: 1px solid rgba(255, 255, 255, 0.1);
			color: #95a5a6;
			font-size: 0.85em;
			line-height: 1.4;
		}

		.loading {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.8);
			backdrop-filter: blur(5px);
			z-index: 1000;
			justify-content: center;
			align-items: center;
			flex-direction: column;
		}

		.loading.active {
			display: flex;
		}

		.spinner {
			width: 50px;
			height: 50px;
			border: 4px solid rgba(255, 255, 255, 0.1);
			border-top: 4px solid #3498db;
			border-radius: 50%;
			animation: spin 1s linear infinite;
			margin-bottom: 15px;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}

		.loading-text {
			color: #ecf0f1;
			font-size: 1.1em;
		}

		@media (max-width: 1100px) {
			.main-content {
				gap: 20px;
			}

			.control-panel {
				min-width: 280px;
				max-width: 350px;
			}

			.visualization-area {
				min-width: 450px;
			}

			.graph-container {
				height: 320px;
			}
		}

		@media (max-width: 900px) {
			.main-content {
				flex-direction: column;
			}

			.control-panel,
			.visualization-area {
				min-width: 100%;
				max-width: 100%;
			}

			.control-panel {
				order: 1;
			}

			.visualization-area {
				order: 2;
			}

			.header h1 {
				font-size: 2em;
			}

			.file-upload-area {
				padding: 25px 15px;
			}

			.upload-icon {
				font-size: 36px;
			}

			.upload-text {
				font-size: 1em;
			}

			.upload-hint {
				font-size: 0.8em;
			}
		}

		@media (max-width: 600px) {
			body {
				padding: 10px;
			}

			.container {
				padding: 15px;
			}

			.header h1 {
				font-size: 1.8em;
			}

			.header .subtitle {
				font-size: 1em;
			}

			.control-panel,
			.visualization-area {
				padding: 20px;
			}

			.graph-container {
				height: 280px;
			}

			.status-bar {
				flex-direction: column;
				align-items: stretch;
				gap: 10px;
				padding: 12px;
			}

			.status-item {
				min-width: auto;
			}

			.playback-controls {
				min-width: auto;
				flex-direction: column;
				gap: 10px;
			}

			.playback-btn {
				width: 40px;
				height: 40px;
				font-size: 1em;
			}

			.btn {
				padding: 10px 12px;
				font-size: 0.9em;
				gap: 5px;
			}

			.info-item {
				flex-direction: column;
				align-items: flex-start;
				gap: 2px;
			}

			.info-value {
				text-align: left;
			}

			.time-display {
				min-width: auto;
				font-size: 0.85em;
			}
		}

		@media (max-width: 400px) {
			.btn span {
				font-size: 0.85em;
			}

			.upload-text {
				font-size: 0.95em;
			}

			.upload-hint {
				font-size: 0.75em;
			}

			.graph-container {
				height: 250px;
			}

			.control-buttons {
				flex-direction: column;
			}

			.btn {
				width: 100%;
			}
		}
	</style>
</HEAD>

<BODY>
	<div class="loading" id="loading">
		<div class="spinner"></div>
		<div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...</div>
	</div>

	<div class="container">
		<div class="header">
			<h1>üéµ BDF Audio Player</h1>
			<div class="subtitle">–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è BDF-—Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –∞—É–¥–∏–æ–±—É—Ñ–µ—Ä</div>
			<div class="subtitle">–ê—Å—Ç–∞–Ω–∏–Ω 10-12-2025</div>
		</div>

		<div class="main-content">
			<div class="control-panel">
				<div class="file-upload-area" id="uploadArea">
					<input type="file" id="fileInput" accept=".bdf">
					<label for="fileInput" class="upload-label">
						<div class="upload-icon">üìÅ</div>
						<div class="upload-text">–í—ã–±–µ—Ä–∏—Ç–µ BDF-—Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</div>
						<div class="upload-hint">–ù–∞–∂–º–∏—Ç–µ –∑–¥–µ—Å—å –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª</div>
					</label>
				</div>

				<div class="file-info" id="fileInfo">
					<div class="info-item">
						<span class="info-label">–ò–º—è —Ñ–∞–π–ª–∞:</span>
						<span class="info-value" id="fileName">-</span>
					</div>
					<div class="info-item">
						<span class="info-label">–†–∞–∑–º–µ—Ä:</span>
						<span class="info-value" id="fileSize">-</span>
					</div>
					<div class="info-item">
						<span class="info-label">–ù–∞—á–∞–ª–æ –∑–∞–ø–∏—Å–∏:</span>
						<span class="info-value" id="beginDateTime">-</span>
					</div>
					<div class="info-item">
						<span class="info-label">–ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏:</span>
						<span class="info-value" id="sampleFreq">-</span>
					</div>
					<div class="info-item">
						<span class="info-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—Å—á—ë—Ç–æ–≤:</span>
						<span class="info-value" id="sampleCount">-</span>
					</div>
					<div class="info-item">
						<span class="info-label">–£—Ä–æ–≤–µ–Ω—å (–º):</span>
						<span class="info-value" id="urovValue">-</span>
					</div>
				</div>

				<div class="control-buttons">
					<button class="btn btn-primary" id="playBtn" disabled>
						<span>‚ñ∂Ô∏è –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏</span>
					</button>
					<button class="btn btn-secondary" id="stopBtn" disabled>
						<span>‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</span>
					</button>
				</div>
			</div>

			<div class="visualization-area">
				<div class="graph-container">
					<canvas id="graphCanvas"></canvas>
					<div class="graph-overlay">–°–∏–≥–Ω–∞–ª BDF</div>
				</div>

				<div class="status-bar">
					<div class="status-item">
						<div class="status-label">–°—Ç–∞—Ç—É—Å</div>
						<div class="status-value" id="statusText">–ì–æ—Ç–æ–≤ –∫ –∑–∞–≥—Ä—É–∑–∫–µ</div>
					</div>

					<div class="playback-controls">
						<button class="playback-btn" id="playPauseBtn" disabled>‚ñ∂Ô∏è</button>
						<div class="progress-container" id="progressContainer">
							<div class="progress-bar" id="progressBar"></div>
						</div>
						<div class="time-display" id="timeDisplay">00:00 / 00:00</div>
					</div>
				</div>
			</div>
		</div>

		<div class="footer">
			<p>BDF Audio Player v1.0 | –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Web Audio API</p>
			<p>–î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ | –í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ</p>
		</div>
	</div>

	<SCRIPT>
		// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
		const amp_max = 32768;
		let freq_samles = 1020;
		const write_seconds = 21;
		let data_in = null;
		let size_data = 0;
		let audioContext = null;
		let sourceNode = null;
		let isPlaying = false;
		let currentFile = null;
		let canvasCtx = null;
		let currentDataArray = null;
		let animationFrameId = null;

		// –≠–ª–µ–º–µ–Ω—Ç—ã DOM
		const fileInput = document.getElementById('fileInput');
		const uploadArea = document.getElementById('uploadArea');
		const fileInfo = document.getElementById('fileInfo');
		const playBtn = document.getElementById('playBtn');
		const stopBtn = document.getElementById('stopBtn');
		const playPauseBtn = document.getElementById('playPauseBtn');
		const progressContainer = document.getElementById('progressContainer');
		const progressBar = document.getElementById('progressBar');
		const timeDisplay = document.getElementById('timeDisplay');
		const statusText = document.getElementById('statusText');
		const loading = document.getElementById('loading');
		const graphCanvas = document.getElementById('graphCanvas');

		// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–Ω–≤–∞—Å–∞
		function initCanvas() {
			canvasCtx = graphCanvas.getContext('2d');
			resizeCanvas();
		}

		function resizeCanvas() {
			const parent = graphCanvas.parentElement;
			const width = parent.clientWidth;
			const height = parent.clientHeight;

			// –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∫–∞–Ω–≤–∞—Å–∞ —Å —É—á–µ—Ç–æ–º pixel ratio
			const dpr = window.devicePixelRatio || 1;
			graphCanvas.width = width * dpr;
			graphCanvas.height = height * dpr;
			graphCanvas.style.width = width + 'px';
			graphCanvas.style.height = height + 'px';

			// –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç
			if (dpr !== 1) {
				canvasCtx.scale(dpr, dpr);
			}

			// –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ - –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º
			if (currentDataArray && currentDataArray.length > 0) {
				drawSignal();
			} else {
				clearCanvas();
			}
		}

		function clearCanvas() {
			if (!canvasCtx || !graphCanvas.width || !graphCanvas.height) return;

			const width = graphCanvas.width / (window.devicePixelRatio || 1);
			const height = graphCanvas.height / (window.devicePixelRatio || 1);

			// –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º –∫–∞–Ω–≤–∞—Å
			canvasCtx.clearRect(0, 0, width, height);

			// –ó–∞–ª–∏–≤–∞–µ–º —Ñ–æ–Ω
			canvasCtx.fillStyle = 'rgba(0, 0, 0, 0.5)';
			canvasCtx.fillRect(0, 0, width, height);

			// –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª"
			canvasCtx.fillStyle = 'rgba(255, 255, 255, 0.3)';
			canvasCtx.font = '20px Arial';
			canvasCtx.textAlign = 'center';
			canvasCtx.textBaseline = 'middle';
			canvasCtx.fillText('–ó–∞–≥—Ä—É–∑–∏—Ç–µ BDF —Ñ–∞–π–ª –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞', width / 2, height / 2);
		}

		// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–∏–∫–æ–π
		function drawSignal() {
			if (!canvasCtx || !graphCanvas.width || !graphCanvas.height || !currentDataArray || currentDataArray.length === 0) {
				clearCanvas();
				return;
			}

			// –û—Ç–º–µ–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
			if (animationFrameId) {
				cancelAnimationFrame(animationFrameId);
				animationFrameId = null;
			}

			// –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–∏
			animationFrameId = requestAnimationFrame(() => {
				try {
					const dpr = window.devicePixelRatio || 1;
					const width = graphCanvas.width / dpr;
					const height = graphCanvas.height / dpr;
					const centerY = height / 2;
					const ampScale = height * 0.4;

					// –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º –∫–∞–Ω–≤–∞—Å –ø–µ—Ä–µ–¥ —Ä–∏—Å–æ–≤–∞–Ω–∏–µ–º
					canvasCtx.clearRect(0, 0, width, height);

					// –ó–∞–ª–∏–≤–∞–µ–º —Ñ–æ–Ω
					canvasCtx.fillStyle = 'rgba(0, 0, 0, 0.5)';
					canvasCtx.fillRect(0, 0, width, height);

					// –†–∏—Å—É–µ–º —Å—Ä–µ–¥–Ω—é—é –ª–∏–Ω–∏—é
					canvasCtx.beginPath();
					canvasCtx.strokeStyle = 'rgba(52, 152, 219, 0.5)';
					canvasCtx.lineWidth = 1;
					canvasCtx.moveTo(0, centerY);
					canvasCtx.lineTo(width, centerY);
					canvasCtx.stroke();

					// –†–∏—Å—É–µ–º —Å–∏–≥–Ω–∞–ª
					const compress = Math.max(1, Math.floor(size_data / width));
					canvasCtx.beginPath();
					canvasCtx.strokeStyle = '#e74c3c';
					canvasCtx.lineWidth = 2;

					let moved = false;
					for (let i = 0; i < width; i++) {
						let sample = 0;
						let validSamples = 0;

						if (compress > 1) {
							for (let j = 0; j < compress; j++) {
								const index = i * compress + j;
								if (index < size_data && index < currentDataArray.length) {
									sample += currentDataArray[index];
									validSamples++;
								}
							}
							if (validSamples > 0) {
								sample /= validSamples;
							}
						} else if (i < size_data && i < currentDataArray.length) {
							sample = currentDataArray[i];
						}

						const x = i;
						const y = centerY - (sample / amp_max) * ampScale;

						if (!moved) {
							canvasCtx.moveTo(x, y);
							moved = true;
						} else {
							canvasCtx.lineTo(x, y);
						}
					}

					canvasCtx.stroke();

					// –†–∏—Å—É–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ (1 —Å–µ–∫—É–Ω–¥–∞)
					if (freq_samles > 0 && compress > 0) {
						canvasCtx.strokeStyle = 'rgba(52, 152, 219, 0.3)';
						canvasCtx.lineWidth = 1;

						const step = freq_samles / compress;
						for (let x = 0; x < width; x += step) {
							canvasCtx.beginPath();
							canvasCtx.moveTo(x, centerY - ampScale);
							canvasCtx.lineTo(x, centerY + ampScale);
							canvasCtx.stroke();
						}
					}

					// –†–∏—Å—É–µ–º —Å–µ—Ç–∫—É
					// drawGrid(width, height);

				} catch (error) {
					console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∏—Å–æ–≤–∞–Ω–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞:', error);
				}
			});
		}

		function drawGrid(width, height) {
			// –†–∏—Å—É–µ–º —Å–µ—Ç–∫—É
			canvasCtx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
			canvasCtx.lineWidth = 0.5;

			// –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ (–∫–∞–∂–¥—ã–µ 50px)
			for (let x = 0; x <= width; x += 50) {
				canvasCtx.beginPath();
				canvasCtx.moveTo(x, 0);
				canvasCtx.lineTo(x, height);
				canvasCtx.stroke();
			}

			// –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ (–∫–∞–∂–¥—ã–µ 50px)
			for (let y = 0; y <= height; y += 50) {
				canvasCtx.beginPath();
				canvasCtx.moveTo(0, y);
				canvasCtx.lineTo(width, y);
				canvasCtx.stroke();
			}
		}

		// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
		fileInput.addEventListener('change', handleFileSelect);
		uploadArea.addEventListener('dragover', (e) => {
			e.preventDefault();
			uploadArea.style.background = 'rgba(52, 152, 219, 0.2)';
		});

		uploadArea.addEventListener('dragleave', () => {
			uploadArea.style.background = 'rgba(52, 152, 219, 0.1)';
		});

		uploadArea.addEventListener('drop', (e) => {
			e.preventDefault();
			uploadArea.style.background = 'rgba(52, 152, 219, 0.1)';
			if (e.dataTransfer.files.length) {
				fileInput.files = e.dataTransfer.files;
				handleFileSelect();
			}
		});

		playBtn.addEventListener('click', playAudio);
		stopBtn.addEventListener('click', stopAudio);
		playPauseBtn.addEventListener('click', togglePlayPause);
		progressContainer.addEventListener('click', seekAudio);

		// –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤—Å–µ –≤–∞—à–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
		function putpixel(x, y, c, w) {
			// –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ–ø–µ—Ä—å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è
		}

		function sim(xc, yc, x, y, c, w) {
			// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
		}

		function circle(xc, yc, r, c, w) {
			// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
		}

		function line(xl, yl, x2, y2, c, w) {
			// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
		}

		function ExpAvg(x, len, Fs, Fc) {
			var betta = 1 / (1 + Fs / (2 * 3.1415926 * Fc));
			for (var i = 1; i < len; i++) {
				x[i] = (betta * x[i] + (1.0 - betta) * x[i - 1]);
			}
			return betta;
		}

		function findSequence(arr, sequence) {
			const seqLen = sequence.length;
			for (let i = 0; i <= arr.length - seqLen; i++) {
				let match = true;
				for (let j = 0; j < seqLen; j++) {
					if (arr[i + j] !== sequence[j]) {
						match = false;
						break;
					}
				}
				if (match) {
					return i;
				}
			}
			return -1;
		}

		function find_Urov(data) {
			var res = 0;
			const find_string = "Urov(m)";
			var arr = [];
			for (var i = 0; i < find_string.length; i++) {
				arr[i] = find_string.charCodeAt(i);
			}
			res = findSequence(data, arr);
			if (res > 0) {
				res += arr.length;
				if ((data[res + 3] == 0x3d) && (data[res + 5] == 4)) {
					var buffer = new ArrayBuffer(4);
					var uint8View = new Uint8Array(buffer);
					uint8View[0] = data[res + 7];
					uint8View[1] = data[res + 8];
					uint8View[2] = data[res + 9];
					uint8View[3] = data[res + 10];
					var f = new Float32Array(buffer);
					res = f[0];
				} else {
					res = -1;
				}
			}
			return res;
		}

		function find_DateTime(data) {
			var sDateTime = {
				found: false,
				year: 0,
				month: 0,
				day: 0,
				hour: 0,
				min: 0,
				sec: 0,
				mSec: 0,
				tz: 0,
				dateString: "-",
				timeString: "-"
			};
			var res = 0;
			const find_string = "BeginDateTime";
			var arr = [];
			for (var i = 0; i < find_string.length; i++) {
				arr[i] = find_string.charCodeAt(i);
			}
			res = findSequence(data, arr);
			if (res > 0) {
				res += arr.length;
				if ((data[res + 3] == 0x3d) && (data[res + 4] == 4)) {
					var base = res + 7;

					sDateTime.year = (data[base] + (data[base + 1] << 8));
					sDateTime.month = data[base + 2];
					sDateTime.day = data[base + 3];
					sDateTime.hour = data[base + 4];
					sDateTime.min = data[base + 5];
					sDateTime.sec = data[base + 6];

					sDateTime.found = true;
					sDateTime.dateString = formatDate(sDateTime.year, sDateTime.month, sDateTime.day);
					sDateTime.timeString = formatTime(sDateTime.hour, sDateTime.min, sDateTime.sec);

				}
			}
			return sDateTime;
		}

		function formatDate(year, month, day) {
			// –î–æ–±–∞–≤–ª—è–µ–º 2000 –∫ –≥–æ–¥—É, –µ—Å–ª–∏ –æ–Ω –º–µ–Ω—å—à–µ 100
			if (year < 100) {
				year += 2000;
			}

			// –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å –≤–µ–¥—É—â–∏–º–∏ –Ω—É–ª—è–º–∏
			const monthStr = month.toString().padStart(2, '0');
			const dayStr = day.toString().padStart(2, '0');

			return `${dayStr}.${monthStr}.${year}`;
		}

		// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
		function formatTime(hour, min, sec) {
			// –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å –≤–µ–¥—É—â–∏–º–∏ –Ω—É–ª—è–º–∏
			const hourStr = hour.toString().padStart(2, '0');
			const minStr = min.toString().padStart(2, '0');
			const secStr = sec.toString().padStart(2, '0');

			return `${hourStr}:${minStr}:${secStr}`;
		}

		function find_SampleFreq(data) {
			var res = 0;
			const find_string = "SampleFreq";
			var arr = [];
			for (var i = 0; i < find_string.length; i++) {
				arr[i] = find_string.charCodeAt(i);
			}
			res = findSequence(data, arr);
			if (res > 0) {
				res += arr.length;
				if ((data[res + 3] == 0x3d) && (data[res + 5] == 4)) {
					res = ((data[res + 7]) << 0) + ((data[res + 8]) << 8) + ((data[res + 9]) << 16) + ((data[res + 10]) << 24);
				} else {
					res = -1;
				}
			}
			return res;
		}

		function find_SampleCnt(data) {
			var res = 0;
			const find_string = "SampleCnt";
			var arr = [];
			for (var i = 0; i < find_string.length; i++) {
				arr[i] = find_string.charCodeAt(i);
			}
			res = findSequence(data, arr);
			if (res > 0) {
				res += arr.length;
				if ((data[res + 3] == 0x3d) && (data[res + 5] == 4)) {
					res = ((data[res + 7]) << 0) + ((data[res + 8]) << 8) + ((data[res + 9]) << 16) + ((data[res + 10]) << 24);
				} else {
					res = -1;
				}
			}
			return res;
		}

		function find_EchoRawChart(data, out_data) {
			var res = 0;
			var d16 = 0;
			const find_string = "EchoRawChart";
			var arr = [];
			for (var i = 0; i < find_string.length; i++) {
				arr[i] = find_string.charCodeAt(i);
			}
			res = findSequence(data, arr);
			if (res > 0) {
				res += arr.length;
				if ((data[res + 3] == 0x3d)) {
					var base = (res + 7);
					var num = data[res + 4];
					var cnt = (data[res + 5]) + ((data[res + 6]) << 8);
					var out_data_num = 0;
					var id = data[res + 3];
					if ((cnt > 0) && (cnt <= 65536)) {
						while ((id == 0x3d) && (cnt > 0)) {
							for (var i = 0; i < (cnt - 1); i += 2) {
								d16 = ((data[base + i]) << 0) + ((data[base + i + 1]) << 8);
								out_data[out_data_num++] = d16;
							}
							base += cnt;
							base += 2;
							id = data[base++];
							if (id == 0x3d) {
								num = data[base++];
								cnt = (data[base++]) + ((data[base++]) << 8);
							} else {
								break;
							}
						}
						res = out_data_num;
					}
				} else {
					res = -1;
				}
			}
			return res;
		}

		// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞
		async function handleFileSelect() {
			// –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
			if (isPlaying) {
				stopAudio();
			}

			// –û—Ç–º–µ–Ω—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
			if (animationFrameId) {
				cancelAnimationFrame(animationFrameId);
				animationFrameId = null;
			}

			// –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ
			currentDataArray = null;
			size_data = 0;

			// –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º –∫–∞–Ω–≤–∞—Å
			clearCanvas();

			if (!fileInput.files.length) return;

			const file = fileInput.files[0];
			currentFile = file;

			// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
			document.getElementById('fileName').textContent = file.name;
			document.getElementById('fileSize').textContent = formatFileSize(file.size);

			// –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
			document.getElementById('sampleFreq').textContent = '-';
			document.getElementById('sampleCount').textContent = '-';
			document.getElementById('urovValue').textContent = '-';

			fileInfo.classList.add('active');
			loading.classList.add('active');
			statusText.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...';
			statusText.style.color = '#f39c12';

			// –°–±—Ä–∞—Å—ã–≤–∞–µ–º UI —ç–ª–µ–º–µ–Ω—Ç—ã
			playBtn.disabled = true;
			playPauseBtn.disabled = true;
			stopBtn.disabled = true;
			progressBar.style.width = '0%';
			updateTimeDisplay(0, 0);

			try {
				const arrayBuffer = await file.arrayBuffer();
				const uint8Array = new Uint8Array(arrayBuffer);

				// –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ BDF —Ñ–∞–π–ª–∞
				const DateTime = find_DateTime(uint8Array);
				const urov = find_Urov(uint8Array);
				freq_samles = find_SampleFreq(uint8Array);
				const sampleCount = find_SampleCnt(uint8Array);

				// –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
				const x_dimension = write_seconds * freq_samles;
				data_in = Array(x_dimension).fill(0);
				size_data = find_EchoRawChart(uint8Array, data_in);

				// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
				currentDataArray = data_in.slice(0, size_data);

				// –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
				if (DateTime.found) {
					document.getElementById('beginDateTime').textContent = `${DateTime.dateString} ${DateTime.timeString}`;
				} else {
					document.getElementById('beginDateTime').textContent = '–ù–µ –Ω–∞–π–¥–µ–Ω–æ';
				}
				document.getElementById('sampleFreq').textContent = freq_samles + ' –ì—Ü';
				document.getElementById('sampleCount').textContent = sampleCount;
				document.getElementById('urovValue').textContent = urov.toFixed(2) + ' –º';

				if (freq_samles > 0 && sampleCount > 0 && size_data > 0) {
					// –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º —Å–º–µ—â–µ–Ω–∏–µ
					let bias = 0;
					for (let i = 0; i < size_data; i++) {
						bias += data_in[i];
					}
					bias /= size_data;
					for (let i = 0; i < size_data; i++) {
						data_in[i] -= bias;
					}

					// –û–±–Ω–æ–≤–ª—è–µ–º currentDataArray –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
					currentDataArray = data_in.slice(0, size_data);

					// –†–∏—Å—É–µ–º —Å–∏–≥–Ω–∞–ª (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏)
					setTimeout(() => {
						drawSignal();
					}, 100);

					// –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏
					playBtn.disabled = false;
					playPauseBtn.disabled = false;
					statusText.textContent = '–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω';
					statusText.style.color = '#2ecc71';

				} else {
					statusText.textContent = '–û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞';
					statusText.style.color = '#e74c3c';
					clearCanvas();
				}
			} catch (error) {
				console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞:', error);
				statusText.textContent = '–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–∞';
				statusText.style.color = '#e74c3c';
				clearCanvas();
			} finally {
				loading.classList.remove('active');
			}
		}

		// –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ
		function playAudio() {
			if (!data_in || size_data === 0) return;

			if (audioContext && isPlaying) {
				stopAudio();
			}

			try {
				audioContext = new (window.AudioContext || window.webkitAudioContext)();
			} catch (e) {
				console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è AudioContext:', e);
				statusText.textContent = '–û—à–∏–±–∫–∞: Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è';
				statusText.style.color = '#e74c3c';
				return;
			}

			const sampleRate = 8000;
			const dataRate = sampleRate / freq_samles;
			const bufferSize = Math.floor(size_data * dataRate);
			const audioBuffer = audioContext.createBuffer(1, bufferSize, sampleRate);
			const channelData = audioBuffer.getChannelData(0);

			// –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
			for (let i = 0; i < bufferSize; i++) {
				const expand_index = Math.floor(i / dataRate);
				if (expand_index < size_data) {
					channelData[i] = data_in[expand_index] / amp_max;
				} else {
					channelData[i] = 0;
				}
			}

			// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
			const f_cut = 60 * 1.5;
			ExpAvg(channelData, bufferSize, sampleRate, f_cut);

			// –°–æ–∑–¥–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫
			sourceNode = audioContext.createBufferSource();
			sourceNode.buffer = audioBuffer;
			sourceNode.connect(audioContext.destination);

			// –û–±–Ω–æ–≤–ª—è–µ–º UI
			isPlaying = true;
			playPauseBtn.innerHTML = '‚è∏Ô∏è';
			stopBtn.disabled = false;
			playBtn.disabled = true;
			statusText.textContent = '–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ';
			statusText.style.color = '#3498db';

			// –¢–∞–π–º–µ—Ä –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
			const duration = bufferSize / sampleRate;
			updateTimeDisplay(0, duration);

			let startTime = audioContext.currentTime;
			let progressInterval = setInterval(() => {
				if (!isPlaying || !audioContext) {
					clearInterval(progressInterval);
					return;
				}

				const elapsed = audioContext.currentTime - startTime;
				if (elapsed >= duration) {
					clearInterval(progressInterval);
					stopAudio();
					statusText.textContent = '–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
					statusText.style.color = '#2ecc71';
					return;
				}

				const progress = elapsed / duration;
				progressBar.style.width = (progress * 100) + '%';
				updateTimeDisplay(elapsed, duration);
			}, 100);

			// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
			sourceNode.onended = () => {
				clearInterval(progressInterval);
				if (isPlaying) {
					isPlaying = false;
					playPauseBtn.innerHTML = '‚ñ∂Ô∏è';
					playBtn.disabled = false;
					statusText.textContent = '–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
					statusText.style.color = '#2ecc71';
				}
			};

			sourceNode.start(0);
		}

		function stopAudio() {
			if (sourceNode) {
				try {
					sourceNode.stop();
				} catch (e) {
					// –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
				}
				sourceNode = null;
			}
			if (audioContext) {
				try {
					audioContext.close();
				} catch (e) {
					// –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
				}
				audioContext = null;
			}

			isPlaying = false;
			playPauseBtn.innerHTML = '‚ñ∂Ô∏è';
			stopBtn.disabled = true;
			playBtn.disabled = false;
			progressBar.style.width = '0%';
			statusText.textContent = '–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';
			statusText.style.color = '#e74c3c';
			updateTimeDisplay(0, 0);
		}

		function togglePlayPause() {
			if (isPlaying) {
				stopAudio();
			} else {
				playAudio();
			}
		}

		function seekAudio(e) {
			if (!audioContext || !sourceNode || !isPlaying) return;

			const rect = progressContainer.getBoundingClientRect();
			const clickX = e.clientX - rect.left;
			const percentage = Math.max(0, Math.min(1, clickX / rect.width));

			// –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
			sourceNode.stop();

			// –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —Å –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
			const sampleRate = 8000;
			const dataRate = sampleRate / freq_samles;
			const bufferSize = Math.floor(size_data * dataRate);
			const audioBuffer = audioContext.createBuffer(1, bufferSize, sampleRate);
			const channelData = audioBuffer.getChannelData(0);

			for (let i = 0; i < bufferSize; i++) {
				const expand_index = Math.floor(i / dataRate);
				if (expand_index < size_data) {
					channelData[i] = data_in[expand_index] / amp_max;
				} else {
					channelData[i] = 0;
				}
			}

			const f_cut = 60 * 1.5;
			ExpAvg(channelData, bufferSize, sampleRate, f_cut);

			const startSample = Math.floor(percentage * bufferSize);
			const offset = startSample / sampleRate;

			sourceNode = audioContext.createBufferSource();
			sourceNode.buffer = audioBuffer;
			sourceNode.connect(audioContext.destination);

			const duration = bufferSize / sampleRate - offset;

			sourceNode.start(0, offset);
			sourceNode.onended = () => {
				if (isPlaying) {
					stopAudio();
				}
			};

			// –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
			const startTime = audioContext.currentTime - offset;
			const progressInterval = setInterval(() => {
				if (!isPlaying) {
					clearInterval(progressInterval);
					return;
				}

				const elapsed = audioContext.currentTime - startTime;
				if (elapsed >= duration) {
					clearInterval(progressInterval);
					stopAudio();
					return;
				}

				const progress = (offset + elapsed) / (bufferSize / sampleRate);
				progressBar.style.width = (progress * 100) + '%';
				updateTimeDisplay(offset + elapsed, bufferSize / sampleRate);
			}, 100);
		}

		// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
		function formatFileSize(bytes) {
			if (bytes === 0) return '0 Bytes';
			const k = 1024;
			const sizes = ['Bytes', 'KB', 'MB', 'GB'];
			const i = Math.floor(Math.log(bytes) / Math.log(k));
			return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
		}

		function updateTimeDisplay(current, total) {
			const formatTime = (seconds) => {
				const mins = Math.floor(seconds / 60);
				const secs = Math.floor(seconds % 60);
				return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
			};

			if (total === 0) {
				timeDisplay.textContent = '00:00 / 00:00';
			} else {
				timeDisplay.textContent = `${formatTime(current)} / ${formatTime(total)}`;
			}
		}

		// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
		window.addEventListener('DOMContentLoaded', () => {
			initCanvas();
			statusText.textContent = '–ì–æ—Ç–æ–≤ –∫ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞';
		});

		window.addEventListener('resize', () => {
			if (canvasCtx) {
				resizeCanvas();
			}
		});
	</SCRIPT>
</BODY>

</HTML>